---
title: "Project Proposal"
author: "Seokjun Choi and Sho Kawano"
date: "`r Sys.Date()`"
output:
  revealjs::revealjs_presentation: 
    theme: serif
    incremental: false
    reveal_options:
      slideNumber: T
---

```{r include=FALSE}
library(tidyverse)
# library(gridExtra)
data = read.csv("angry_moods.csv") %>% 
          mutate(Sex = ifelse(Sex==2, 0, 1)) %>% 
          mutate(Athlete = ifelse(Athlete==2, 0, 1))
```


## Background  


![](zidane.jpg)

Sports psychologists have been trying to understand the effect of anger on sports performance for a long time.  

Key question: \newline
do athletes handle anger differently than non-athletes?


## How do psychologists measure anger management?

One way: \newline
questionnaire called STATXI-2 (Spielberger et al., 1999) which produces the anger expression (AE) index.

AE:\newline
overall estimate of the personâ€™s tendencies to express anger either outwardly toward other people, or inwardly toward herself


## Components of Anger Expression Index

$AE = AO + AI - CO - CI +48$

+ Anger-Out (AO):  how much a person expresses their anger in an outwardly negative and poorly controlled manner.
+ Anger-In (AI): the extent to which people hold things in or suppress anger when they are angry or furious.
+ Control-Out (CO): measures how much effort does the person expend to control anger.
+ Control-In (CI): measures how often a person attempts to relax, calm down.

# Data Description

Survey data provided from Rice University with the questionnaire to gauge AE.
There are 48 females and 30 males, and 25 athletes and 53 non-athletes.


```{r, echo=FALSE}
data %>% head() %>% as.data.frame()
data$Sex <- factor(data$Sex)
data$Athlete <- factor(data$Athlete)
names(data)[3:7] <- c("AO", "AI", "CO", "CI", "AE")
data$Factors <- factor(
  paste(as.character(data$Sex), as.character(data$Athlete), sep = "_"))
levels(data$Factors) <- c("F_N", "F_A", "M_N", "M_A")
```

Contingency table:

```{r, echo=FALSE}
Sex <- data$Sex
Athlete <- data$Athlete
table(Sex, Athlete)
```

# Main Research Questions 

+ Do athletes and non-athletes deal with anger in the same way?
+ Are there any gender differences?
+ If there are differences by gender and athlete status, how do they differ? 
+ Are there relationships among AO, AI, CO, CI?

# EDA 
<style>
.container{
    display: flex;
}
.col{
    flex: 1;
}
</style>

<div class="container">
<div class="col">



```{r, echo=FALSE, fig.width=4, warning=FALSE}
library(ggpubr)
#par(mfrow = c(1, 3))
levels(data$Sex) <- c("female", "male")
levels(data$Athlete) <- c("Non-athlete", "Athlete")
# boxplot(AE ~ Sex, data = data)
# boxplot(AE ~ Athlete, data = data)
# boxplot(AE ~ Factors, data = data)

boxplot1 <- ggplot(data, aes(y = AE, fill = Sex)) + geom_boxplot() 
boxplot2 <- ggplot(data, aes(y = AE, fill = Athlete)) + geom_boxplot() 
ggarrange(boxplot1, boxplot2, #bp + rremove("x.text"), 
          # labels = c("A", "B", "C"),
          ncol = 1, nrow = 2)
```
</div>
<div class="col">

```{r fig.width=4, echo=FALSE}

data %>% ggplot(aes(y = AE, fill = Factors)) + geom_boxplot()
```

</div>
</div>

# EDA
```{r, echo=FALSE}
par(mfrow = c(2, 2))
boxplot(AO ~ Factors, data = data)
boxplot(AI ~ Factors, data = data)
boxplot(CO ~ Factors, data = data)
boxplot(CI ~ Factors, data = data)
```


# Two-Way ANOVA 

\[AE = \mu + \alpha_i + \beta_j + \gamma_{i,j} +\epsilon \]
where \(\epsilon \sim Normal(0, \sigma^2)\) for fixed $\sigma^2$

- $\alpha_i$: effect of 'gender' (i = 0(female), 1(male))
- $\beta_i$: effect of 'being an athlete' (i = 0(non-athlete), 1(athlete))
- $\gamma_{i,j}$: interaction between gender and being an athlete

Then two main questions reduce to

- $\alpha_0 = \alpha_1$? or $\alpha_0 \neq \alpha_1$?
- $\beta_0 = \beta_1$? or $\beta_0 \neq \beta_1$?

If so, how do they differ?

# Explore Relationships
Can we explain 'AO' by other variables?

```{r, echo=FALSE}
par(mfrow = c(1, 1))
pairs(data[, 3:6])
```

# Discussion 

Any questions? Comments? Suggestions? 


# Additional plots 1

```{r, echo=FALSE}
density_est_AE <- ggplot(data, aes(x = AE)) + 
    geom_density(fill="black") + ylim(0, 0.04)
density_est_AE_eachfactor <- ggplot(data, aes(x = AE, fill = Factors)) + 
    geom_density(alpha=0.5, position="identity") + ylim(0, 0.04)

  
ggarrange(density_est_AE, density_est_AE_eachfactor,
          #bp + rremove("x.text"),
          # labels = c("A", "B", "C"),
          ncol = 1, nrow = 2)
```

# Additional plots 2

```{r, echo=FALSE}
hist_AE <- ggplot(data, aes(x = AE)) + geom_histogram(bins = 20)
hist_AE_col <- ggplot(data, aes(x = AE, fill = Factors)) + geom_histogram(bins = 20)
ggarrange(hist_AE, hist_AE_col,
          #bp + rremove("x.text"),
          # labels = c("A", "B", "C"),
          ncol = 1, nrow = 2)
```

# Additional plots 3

```{r, echo=FALSE}
qq_AE <- qqnorm(data$AE, main = "Normal Q-Q Plot: AE")
qqline(data$AE)
```