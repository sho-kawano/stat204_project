---
title: "EDA Notebook"
author: "Sho"
date: "11/21/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Loading In Data

```{r cars}
data <- read.csv("MH_survey_only_higher_index.csv",
    na.strings = "NA")
names(data)
names(data)[1] <- "gender"

data <- data[, -c(17:22)]


# Assigning factors 
data$gender <- factor(data$gender)
data$age_group <- factor(data$age_group)
data$country_lockdown <- factor(data$country_lockdown)
data$marital <- factor(data$marital)
data$smoking <- factor(data$smoking)
data$fivfruitveg <- factor(data$fivfruitveg)
data$shielded <- factor(data$shielded)
data$week_soc_distancing <- factor(data$week_soc_distancing)
data$athlete <- factor(data$athlete)
```

# Pairs Plot

```{r}
plot(MHC_SF_OVERALL ~ gender, data = data)
plot(MHC_SF_OVERALL ~ age_group, data = data)
plot(MHC_SF_OVERALL ~ country_lockdown, data = data)
plot(MHC_SF_OVERALL ~ marital, data = data)
plot(MHC_SF_OVERALL ~ smoking, data = data)
plot(MHC_SF_OVERALL ~ fivfruitveg, data = data)
plot(MHC_SF_OVERALL ~ hour_sleep, data = data)
plot(MHC_SF_OVERALL ~ week_soc_distancing, data = data)
plot(MHC_SF_OVERALL ~ shielded, data = data)
plot(MHC_SF_OVERALL ~ lockdown_bubble, data = data)
plot(MHC_SF_OVERALL ~ athlete, data = data)
plot(MHC_SF_OVERALL ~ jitter(AIMS_TOTAL), data = data)
abline(line(data$AIMS_TOTAL, data$MHC_SF_OVERALL))
plot(MHC_SF_OVERALL ~ HADS_OVERALL, data = data)
plot(MHC_SF_OVERALL ~ RES_TOTAL, data = data)
plot(MHC_SF_OVERALL ~ LONE_TOTAL, data = data)
plot(MHC_SF_OVERALL ~ lockdown_bubble, data = data)
```


# Checking Balance Across Groups

```{r}
data %>% select(gender, athlete) %>% table()
```


There is imbalances in age_group & athlete/non-athlete.

```{r}
data %>% select(age_group, athlete) %>% table()
```

There is imbalances in age_group & athlete/non-athlete.

```{r}
data %>% select(age_group, gender) %>% table()
```


Most countries were in lockdown.

```{r}
data %>% select(shielded, athlete) %>% table()
```

There is an imbalance in marital status. 

```{r}
data %>% select(marital, athlete) %>% table()
```


```{r}
data %>% select(fivfruitveg, athlete) %>% table()
```

```{r}
data %>% select(smoking, athlete) %>% table()
```


# Other EDA Plots

These are the research questions: 

* Were athletes and non-athletes affected from COVID-19 shutdowns in the same way?
* Did being in a COVID Lockdown affect mental well-being? 
* Are there sex-based differences in the effects of COVID-19 on mental health?
* Under controlled demographic information, what is the relationship between MH-SF index and other sub-indices in this survey?
* Are there additional variable having strong relationship with MH-SF index?


```{r}
data %>% ggplot(aes(x=gender, y=MHC_SF_OVERALL, color=athlete)) + geom_boxplot()
```



```{r}
data %>% 
    mutate(gender = ifelse(gender==1, "Male", "Female"), 
           athlete = ifelse(athlete==1, "Athlete", "Non-Athlete")) %>% 
    mutate(Qurantined=shielded) %>% 
    ggplot(aes(x=athlete, y=MHC_SF_OVERALL, color=Qurantined])) + 
    geom_boxplot() + 
    facet_grid(~gender) + xlab("") + theme_bw()
```

```{r}
data %>% 
    mutate(gender = ifelse(gender==1, "Male", "Female"), 
           athlete = ifelse(athlete==1, "Athlete", "Non-Athlete")) %>% 
    ggplot(aes(x=hour_sleep, fill=athlete)) + geom_histogram() + facet_grid(athlete~gender) + theme_bw()
```


```{r}
data %>% 
    mutate(gender = ifelse(gender==1, "Male", "Female"), 
           athlete = ifelse(athlete==1, "Athlete", "Non-Athlete")) %>% 
    ggplot(aes(x=HADS_OVERALL, y=MHC_SF_OVERALL, color=athlete)) + geom_point() + 
    facet_grid(athlete~gender) + theme_bw() +
    geom_smooth(method="lm", se=FALSE)
```



# Collinearity 

```{r}
library(corrplot)
library(RColorBrewer)

cor_tbl = data %>% select(-MHC_SF_OVERALL) %>%  
    mutate_each(as.numeric)  %>% na.omit() %>% cor()

corrplot(cor_tbl, type="upper", order="hclust", method="color")
```
